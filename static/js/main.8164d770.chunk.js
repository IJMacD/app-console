(this["webpackJsonpapp-console-example"]=this["webpackJsonpapp-console-example"]||[]).push([[0],[,,,function(e,t,n){e.exports=n(12)},,,,,function(e,t,n){},function(e,t,n){},function(e){e.exports=JSON.parse('{"name":"app-console","version":"1.0.0","repository":"http://github.com/ijmacd/app-console.git","author":"Iain MacDonald <IJMacD@gmail.com>","main":"dist/index.js","module":"dist/index.modern.js","source":"src/index.js","bin":"src/cli.js","engines":{"node":">=10"},"scripts":{"build":"microbundle-crl --no-compress --format modern,cjs","start":"microbundle-crl watch --no-compress --format modern,cjs","prepare":"run-s build","test":"run-s test:unit test:lint test:build","test:build":"run-s build","test:lint":"eslint .","test:unit":"cross-env CI=1 react-scripts test --env=jsdom","test:watch":"react-scripts test --env=jsdom","predeploy":"cd example && yarn install && yarn run build","deploy":"gh-pages -d example/build"},"peerDependencies":{"react":"^16.0.0"},"devDependencies":{"microbundle-crl":"^0.13.10","babel-eslint":"^10.0.3","cross-env":"^7.0.2","eslint":"^6.8.0","eslint-config-prettier":"^6.7.0","eslint-config-standard":"^14.1.0","eslint-config-standard-react":"^9.2.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^11.0.0","eslint-plugin-prettier":"^3.1.1","eslint-plugin-promise":"^4.2.1","eslint-plugin-react":"^7.17.0","eslint-plugin-standard":"^4.0.1","gh-pages":"^2.2.0","npm-run-all":"^4.1.5","prettier":"^2.0.4","react":"^16.13.1","react-dom":"^16.13.1","react-scripts":"^3.4.1"},"files":["dist"]}')},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(2),a=n.n(i);n(8),n(9);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var s=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{f(r,1,i(this.v))}catch(a){f(r,2,a)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?f(r,1,t?t(o):o):n?f(r,1,n(o)):f(r,2,o)}catch(a){f(r,2,a)}},r},e}();function f(e,t,n){if(!e.s){if(n instanceof s){if(!n.s)return void(n.o=f.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(f.bind(null,e,t),f.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}function h(e){return e instanceof s&&1&e.s}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function p(e,t,n){for(var r;;){var o=e();if(h(o)&&(o=o.v),!o)return i;if(o.then){r=0;break}var i=n();if(i&&i.then){if(!h(i)){r=1;break}i=i.s}if(t){var a=t();if(a&&a.then&&!h(a)){r=2;break}}}var u=new s,c=f.bind(null,u,2);return(0===r?o.then(p):1===r?i.then(l):a.then(v)).then(void 0,c),u;function l(r){i=r;do{if(t&&(a=t())&&a.then&&!h(a))return void a.then(v).then(void 0,c);if(!(o=e())||h(o)&&!o.v)return void f(u,1,i);if(o.then)return void o.then(p).then(void 0,c);h(i=n())&&(i=i.v)}while(!i||!i.then);i.then(l).then(void 0,c)}function p(e){e?(i=n())&&i.then?i.then(l).then(void 0,c):l(i):f(u,1,i)}function v(){(o=e())?o.then?o.then(p).then(void 0,c):p(o):f(u,1,i)}}function v(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}var d=function(e,t){try{for(var n=this,r=n.context;r;){var o,i=r.executables,a=void 0===i?{}:i;if(e in a)return Promise.resolve((o=a[e]).call.apply(o,[n].concat(t)));r=r.parent}throw Error("Command '"+e+"' not found")}catch(u){return Promise.reject(u)}},m=function(e,t){try{var n=function(n){if(r)return n;try{return o.context.variables[e]=t,t}catch(i){throw Error(e+" is readonly")}},r=!1,o=this,i=o.context,a=p((function(){return!r&&!!i}),void 0,(function(){function n(n){if(r)return n;if(e in l)try{return l[e]=t,r=!0,t}catch(o){throw Error(e+" is readonly")}i=i.parent}var o=i,a=o.executables,u=void 0===a?{}:a,c=o.variables,l=void 0===c?{}:c,s=function(){if("set"in u)return v((function(){return Promise.resolve(u.set(e,t)).then((function(e){return r=!0,e}))}),(function(){}))}();return s&&s.then?s.then(n):n(s)}));return Promise.resolve(a&&a.then?a.then(n):n(a))}catch(u){return Promise.reject(u)}},y=function(e){try{var t=function(t){return n?t:"commands"===e?b.commands.call(r):"variables"===e?[].concat(Object.keys(r.context.variables),["commands","variables"]):void 0},n=!1,r=this,o=r.context,i=p((function(){return!n&&!!o}),void 0,(function(){function t(t){return n?t:e in c?(n=!0,c[e]):void(o=o.parent)}var r=o,i=r.executables,a=void 0===i?{}:i,u=r.variables,c=void 0===u?{}:u,l=function(){if("get"in a)return v((function(){return Promise.resolve(a.get(e)).then((function(e){return n=!0,e}))}),(function(){}))}();return l&&l.then?l.then(t):t(l)}));return Promise.resolve(i&&i.then?i.then(t):t(i))}catch(a){return Promise.reject(a)}},g=function e(t){try{var n=function(n){var i=!1;if(r)return n;function a(n){if(i)return n;var r=t.command,a=t.args;return Promise.resolve(Promise.all(a.map((function(t){return"object"===typeof t?e.call(o,t):t})))).then((function(e){var t;return r in b?(t=b[r]).call.apply(t,[o].concat(e)):d.call(o,r,e)}))}if("string"===typeof t.variable)return y.call(o,t.variable);var u=function(){if("string"===typeof t.operator){var n=function(n){return i?n:Promise.resolve(e.call(o,t.left)).then((function(n){return Promise.resolve(e.call(o,t.right)).then((function(e){switch(t.operator){case"+":return i=!0,n+e;case"-":return i=!0,n-e;case"*":return i=!0,n*e;case"/":return i=!0,n/e}throw Error("Unrecognised operator: "+t.operator)}))}))},r=function(){if("="===t.operator){i=!0;var n=t.name;return Promise.resolve(e.call(o,t.value)).then((function(e){return m.call(o,n,e)}))}}();return r&&r.then?r.then(n):n(r)}}();return u&&u.then?u.then(a):a(u)},r=!1,o=this;if("object"!==typeof t)return Promise.resolve(t);var i=function(){if("object"===typeof t.variable)return r=!0,Promise.resolve(e.call(o,t.variable)).then((function(e){return y.call(o,e)}))}();return Promise.resolve(i&&i.then?i.then(n):n(i))}catch(a){return Promise.reject(a)}},b={ver:function(){return Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_COMMIT_HASH||n(10).version},help:function(){return"Command Interpreter version "+b.ver()+"\n\xa9 Iain MacDonald\n\nBuiltin commands:\n"+b.commands().join("\n")},commands:function(){var e=new Set(Object.keys(b)),t=this.context;for(;t;){var n=t.executables,r=void 0===n?{}:n;Object.keys(r).forEach(e.add.bind(e)),t=t.parent}return Array.from(e).sort()},variables:function(){return this.context.variables},get:y,set:m,date:function(){return new Date},type:function(e){return e instanceof Date?"date":Array.isArray(e)?"list":null===e?"":typeof e},sleep:function(e){return new Promise((function(t){return setTimeout(t,1e3*e)}))},echo:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.flat().filter(D).map(P).join(" ")},cast:function(e,t){return"number"===t?+e:"string"===t?P(e):"list"===t&&"string"===typeof e?e.split("\n"):e},length:function(e){return(Array.isArray(e)?e:"string"===typeof e?e.split("\n"):[e]).length},json:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?null:1===t.length?JSON.stringify(t[0]):JSON.stringify(t)},range:function(e){return Array(e).fill(0).map((function(e,t){return t}))},grep:function(e,t){try{var n=new RegExp(t);return e.filter((function(e){return n.test(e)}))}catch(r){return e.filter((function(e){return e.includes(t)}))}},index:function(e,t){return e[t]},tee:function(e){try{for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.find((function(e){return!e.startsWith("-")}))||"output",a=r.some((function(e){return"-a"===e})),u=function(){if(a)return Promise.resolve(y.call(t,i)).then((function(n){var r=Array.isArray(n)?n:[n];r.push(e),m.call(t,i,r)}));m.call(t,i,e)}();return Promise.resolve(u&&u.then?u.then((function(){return e})):e)}catch(c){return Promise.reject(c)}},eval:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=j(t.join(" "));if(0!==r.length){var o=E(r);return g.call(this,o[0])}}};"undefined"!==typeof alert&&(b.alert=function(){return alert(b.echo.apply(b,arguments))});var x=["foreach","done"],w=["+","-","*","/"],S=function(){function e(e){void 0===e&&(e={}),this.context=e}var t=e.prototype;return t.execute=function(e,t,n){try{var r=this;return void 0===t&&(t=r.output),void 0===n&&(n=r.error),"undefined"===typeof r.context.variables&&(r.context.variables={}),r.output=t,r.error=n,Promise.resolve(v((function(){var o=j(e);if(0!==o.length){var i=E(o);return Promise.resolve(r.executeStatements(i,t,n)).then((function(){}))}}),(function(e){n(e.message)})))}catch(o){return Promise.reject(o)}},t.executeStatements=function(e,t,n){try{var r=this,o=r.context.variables,i=0;return Promise.resolve(p((function(){return i<e.length}),(function(){return i++}),(function(){var a=e[i];return function(){if("foreach"===a.control){var u=b.cast;return Promise.resolve(g.call(r,a.args[0])).then((function(t){function n(t){r.context.forLoop={originalItem:o[t],start:i,items:c,iteration:0,loopVar:t};var n=e.slice(i+1).findIndex((function(e){return"done"===e.control}));if(-1===n)throw Error("Unterminated foreach loop");0!==c.length?o[t]=c[0]:i=n}var c=u.call(b,t,"list");return a.args[1]?Promise.resolve(g.call(r,a.args[1])).then(n):n("item")}))}return function(){if("done"!==a.control)return Promise.resolve(r.executeStatementOperator(a,t,n)).then((function(){}));var e=r.context,o=e.forLoop,u=e.variables;if(!o)throw Error("Unexpected control word: "+a.control);o.iteration++,o.iteration<o.items.length?(i=o.start,u[o.loopVar]=o.items[o.iteration]):("undefined"===typeof o.originalItem?delete u[o.loopVar]:u[o.loopVar]=o.originalItem,r.context.forLoop=null)}()}()})))}catch(a){return Promise.reject(a)}},t.executeStatementOperator=function(e,t,n){try{var r,o=this,i=this.context,a=u({},i,{variables:u({},i.variables)});r="&&"===e.operator?this.executeStatementOperator(e.left,t,n).then((function(){return o.context=a,o.executeStatementOperator(e.right,t,n).then((function(){o.context=i}))})):this.executeStatement(e,t,n);var c=function(){if(!e.background)return Promise.resolve(r).then((function(){}));r.catch((function(e){throw e}))}();return Promise.resolve(c&&c.then?c.then((function(){})):void 0)}catch(l){return Promise.reject(l)}},t.executeStatement=function(e,t,n){try{var r=this,o=r.context.variables,i=v((function(){return Promise.resolve(g.call(r,e)).then((function(e){t(P(e)),o[0]=e}))}),(function(e){n(e.message)}));return Promise.resolve(i&&i.then?i.then((function(){})):void 0)}catch(a){return Promise.reject(a)}},e}();function P(e){return"undefined"===typeof e||null===e?"":e instanceof Date?e.toISOString():Array.isArray(e)?e.map(P).join("\n"):"object"===typeof e?Object.entries(e).map((function(e){return e[0]+" = "+P(e[1])})).join("\n"):String(e)}function j(e){for(var t=[],n=0,r=[{name:"whitespace",regex:/^\s+/,value:function(){return""}},{name:"string",regex:/^"([^"]*)"/,value:function(e){return e.replace(/\\n/g,"\n").replace(/\\t/g,"\t")}},{name:"string_verbatim",regex:/^'[^']*'/,value:function(e){return e.replace(/\\n/g,"\n").replace(/\\t/g,"\t")}},{name:"num",regex:/^-?\d+(?:\.\d+)?/,value:function(e){return+e}},{name:"variable",regex:/^\$+\w+/},{name:"boolean",regex:/^(true|false)/,value:function(e){return"true"===e}},{name:"punctuation",regex:/^(;|\${|}|&&|[|=+*/&])/},{name:"keyword",regex:/^(foreach|done)/},{name:"name",regex:/^[\w-]+/}];n<e.length;){for(var o,i=e.substr(n),a=!1,u=l(r);!(o=u()).done;){var c=o.value,s=c.regex.exec(i);if(s){var f=s[1]||s[0];c.value instanceof Function?f=c.value(f):"undefined"!==typeof c.value&&(f=c.value),"undefined"!==typeof f&&null!==f&&""!==f&&t.push(f),n+=s[0].length,a=!0;break}}if(!a)throw Error("  "+" ".repeat(n)+"^\nUnexpected input at "+n+": "+e.substr(n,10))}return t}function E(e){return C(e,";").map(A)}function A(e){var t=!1;"&"===e[e.length-1]&&(t=!0,e.length--);var n=function(e){return e.reduce((function(e,t){return null===e?t:{operator:"&&",left:e,right:t}}),null)}(C(e,"&&").map(O));return n.background=t,n}function k(e){if(3===e.length&&"string"===typeof e[0]&&"="===e[1])return{operator:"=",name:e[0],value:e[2]};if(3===e.length&&w.includes(e[1]))return{operator:e[1],left:e[0],right:e[2]};if("undefined"!==typeof e[0].variable){if(e.length>1)throw Error("Variable evaluation must be only node in statement");return e[0]}return"number"===typeof e[0]?e[0]:x.includes(e[0])?{control:e[0],args:e.slice(1)}:{command:e[0],args:e.slice(1)}}function O(e){for(var t=[],n=[],r=0;r<e.length;r++){var o=e[r];if("|"===o)t.push(k(n)),n=[];else if("${"===o){var i=e.slice(r+1),a=i.indexOf("}");if(-1===a)throw Error("Unterminated sub-expression");n.push(O(i.slice(0,a))),r+=a+1}else if("number"===typeof o)n.push(o);else if("string"===typeof o&&"$"===o[0]){var u=o.substr(1),c={variable:u};"$"===u[0]&&(c={variable:{variable:u.substr(1)}}),n.push(c)}else if("string"===typeof o&&"'"===o[0]){var l=o.substr(1,o.length-2);n.push(l)}else n.push(o)}if(0===n.length)throw Error("Empty pipe segment");return t.push(k(n)),function(e){return e.reduce((function(e,t){if(null===e)return t;if("undefined"!==typeof t.variable)return{operator:"=",name:t.variable,value:e};if(!t.args)throw Error("Unable to pipe to "+typeof t);return t.args.unshift(e),t}),null)}(t)}function C(e,t){for(var n=[],r=[],o=0;o<e.length;o++)e[o]===t&&r.length?(n.push(r),r=[]):r.push(e[o]);return r.length&&n.push(r),n}function D(e){return!function(e){return"undefined"===typeof e||null===e||""===e}(e)}var I={ConsoleDisplay:"_2okS3","ConsoleDisplay-hist-input":"_2k9nO","ConsoleDisplay-hist-error":"_23Wsh"};function $(e){var t=e.shell,n=void 0===t?null:t,r=e.context,i=void 0===r?{}:r,a=e.style,c=void 0===a?{}:a,l=e.onClose,s=void 0===l?null:l,f=o.a.useState([]),h=f[0],p=f[1],v=o.a.useState(""),d=v[0],m=v[1],y=o.a.useState(0),g=y[0],b=y[1],x=o.a.useState(!1),w=x[0],P=x[1],j=o.a.useRef(),E=o.a.useRef(n||new S(i)),A=o.a.useRef(),k=o.a.useState(c.color),O=k[0],C=k[1],D=o.a.useState(c.backgroundColor),$=D[0],_=D[1];o.a.useEffect((function(){i.parent={variables:{textColor:O,backgroundColor:$},executables:{set:function(e,t){if("textColor"===e)return C(t);if("backgroundColor"===e)return _(t);throw Error("Unhandled")},exit:s||function(){},clear:function(){return p([])}}}}),[i,O,C,$,_,s,p]),o.a.useEffect((function(){j.current&&j.current.focus(),A.current&&(A.current.scrollTop=A.current.scrollHeight)}),[h,w]);var N=o.a.useCallback((function(e){function t(e){p((function(t){return[].concat(t,[e])}))}!function(e){try{e.preventDefault(),m(""),b(0),t({value:d,type:"input"});var n=function(){if(E.current)return P(!0),Promise.resolve(E.current.execute(d,(function(e){t({value:e,type:"output"})}),(function(e){t({value:e,type:"error"})}))).then((function(){P(!1)}));t({value:"No interpreter specified",type:"error"})}();Promise.resolve(n&&n.then?n.then((function(){})):void 0)}catch(e){return Promise.reject(e)}}(e)}),[d,m,b,p,P]);var T=u({height:"100%"},c,{color:O,background:$});return o.a.createElement("div",{className:I.ConsoleDisplay,ref:A,onClick:function(){return"Range"!==getSelection().type&&j.current.focus()},style:T},o.a.createElement("ul",null,h.map((function(e,t){return o.a.createElement("li",{key:t,className:I["ConsoleDisplay-hist-"+e.type]},e.value)}))),o.a.createElement("form",{onSubmit:N},!w&&"> ",o.a.createElement("input",{value:d,ref:j,disabled:w,onChange:function(e){return m(e.target.value)},onKeyUp:function(e){var t=h.filter((function(e){return"input"===e.type&&e.value})),n=NaN;"ArrowUp"===e.key?n=Math.min(g+1,t.length):"ArrowDown"===e.key&&(n=Math.max(g-1,0)),isNaN(n)||(b(n),0===n&&0!==g?m(""):0!==n&&m(t[t.length-n].value))},onKeyDown:function(e){return"ArrowUp"===e.key&&e.preventDefault()},autoFocus:!0})))}n(11);var _={demo(){return this.execute('\necho Welcome to the demo "script.";\nsleep 1;\necho Sit back and watch some sample commands;\nsleep 1;\necho executed before your "eyes!";\nsleep 1;\necho ">" date;\ndate;\nsleep 1;\necho ">" sleep 3;\nsleep 3;\necho ">" date;\ntee ${date} d;\nsleep 1;\necho ">" echo \'$0\';\necho $d;\nsleep 1;\necho ">" 5 + 2;\n5 + 2;\nsleep 1;\necho ">" a = \'${6 * 2}\';\na = ${6 * 2};\nsleep 1;\necho ">" echo Answer is \'$a\';\necho Answer is $a;\nsleep 1;\necho ">" range 3;\nrange 3;\nsleep 1;\necho ">" \'$0 | json\';\nrange 3 | json;\nsleep 1;\necho \'> range 50 | grep 7\' ;\nrange 50 | grep 7;\necho \' \';\necho \'Thanks!\';\n')}};var N=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("p",null,"Type demo or help to get started."),o.a.createElement($,{context:{executables:_}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[3,1,2]]]);
//# sourceMappingURL=main.8164d770.chunk.js.map