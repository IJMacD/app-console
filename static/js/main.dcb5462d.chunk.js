(this["webpackJsonpapp-console-example"]=this["webpackJsonpapp-console-example"]||[]).push([[0],{17:function(e,t,n){e.exports=n(27)},22:function(e,t,n){},23:function(e,t,n){},25:function(e){e.exports=JSON.parse('{"name":"app-console","version":"1.0.0","repository":"http://github.com/ijmacd/app-console.git","author":"Iain MacDonald <IJMacD@gmail.com>","main":"dist/index.js","module":"dist/index.modern.js","source":"src/index.js","bin":"src/cli.js","engines":{"node":">=10"},"scripts":{"build":"microbundle-crl --no-compress --format modern,cjs","start":"microbundle-crl watch --no-compress --format modern,cjs","prepare":"run-s build","test":"run-s test:unit test:lint test:build","test:build":"run-s build","test:lint":"eslint .","test:unit":"cross-env CI=1 react-scripts test --env=jsdom","test:watch":"react-scripts test --env=jsdom","predeploy":"cd example && yarn install && yarn run build","deploy":"gh-pages -d example/build"},"peerDependencies":{"react":"^16.0.0"},"devDependencies":{"microbundle-crl":"^0.13.10","babel-eslint":"^10.0.3","cross-env":"^7.0.2","eslint":"^6.8.0","eslint-config-prettier":"^6.7.0","eslint-config-standard":"^14.1.0","eslint-config-standard-react":"^9.2.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^11.0.0","eslint-plugin-prettier":"^3.1.1","eslint-plugin-promise":"^4.2.1","eslint-plugin-react":"^7.17.0","eslint-plugin-standard":"^4.0.1","gh-pages":"^2.2.0","npm-run-all":"^4.1.5","prettier":"^2.0.4","react":"^16.13.1","react-dom":"^16.13.1","react-scripts":"^3.4.1"},"files":["dist"]}')},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(13),c=n.n(o),i=(n(22),n(23),n(7)),s=n(11),u=n(14),l=n(4),p=n(5),f=n(15),h=n(16),b=n(1),d=n.n(b),v=n(2),m={ver:function(){return Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_COMMIT_HASH||n(25).version},help:function(){return"Command Interpreter version ".concat(m.ver(),"\n\xa9 Iain MacDonald\n\nBuiltin commands:\n").concat(m.commands().join("\n"))},commands:function(){var e=new Set(Object.keys(m)),t=this.context;for(;t;){var n=t.executables,r=void 0===n?{}:n;Object.keys(r).forEach(e.add.bind(e)),t=t.parent}return Array.from(e).sort()},variables(){return this.context.variables},get:O,set:S,date:function(){return new Date},type:function(e){return e instanceof Date?"date":Array.isArray(e)?"list":null===e?"":typeof e},sleep:function(e){return new Promise((function(t){return setTimeout(t,1e3*e)}))},echo:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.flat().filter(M).map(k).join(" ")},cast:function(e,t){return"number"===t?+e:"string"===t?k(e):"list"===t&&"string"===typeof e?e.split("\n"):e},length:function(e){return(Array.isArray(e)?e:"string"===typeof e?e.split("\n"):[e]).length},json:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?null:1===t.length?JSON.stringify(t[0]):JSON.stringify(t)},range:function(e){return Array(e).fill(0).map((function(e,t){return t}))},grep:function(e,t){try{var n=new RegExp(t);return e.filter((function(e){return n.test(e)}))}catch(r){return e.filter((function(e){return e.includes(t)}))}},index:function(e,t){return e[t]},tee(e){var t=arguments,n=this;return Object(v.a)(d.a.mark((function r(){var a,o,c,i,s,u;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(a=t.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=t[c];if(i=o.find((function(e){return!e.startsWith("-")}))||"output",!o.some((function(e){return"-a"===e}))){r.next=15;break}return r.next=6,O.call(n,i);case 6:if(r.t0=r.sent,r.t0){r.next=9;break}r.t0=[];case 9:s=r.t0,(u=Array.isArray(s)?s:[s]).push(e),S.call(n,i,u),r.next=16;break;case 15:S.call(n,i,e);case 16:return r.abrupt("return",e);case 17:case"end":return r.stop()}}),r)})))()},eval(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=A(t.join(" "));if(0!==r.length){var a=$(r);return w.call(this,a[0])}}};"undefined"!==typeof alert&&(m.alert=function(){return alert(m.echo.apply(m,arguments))});var x=["foreach","done"],g=["+","-","*","/"],y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(f.a)(this,e),this.context=t}return Object(h.a)(e,[{key:"execute",value:function(){var e=Object(v.a)(d.a.mark((function e(t){var n,r,a,o,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:this.output,r=c.length>2&&void 0!==c[2]?c[2]:this.error,"undefined"===typeof this.context.variables&&(this.context.variables={}),this.output=n,this.error=r,e.prev=5,0!==(a=A(t)).length){e.next=9;break}return e.abrupt("return");case 9:return o=$(a),e.next=12,this.executeStatements(o,n,r);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),r(e.t0.message);case 17:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"executeStatements",value:function(){var e=Object(v.a)(d.a.mark((function e(t,n,r){var a,o,c,i,s,u,l,p,f;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.context.variables,o=0;case 2:if(!(o<t.length)){e.next=43;break}if("foreach"!==(c=t[o]).control){e.next=28;break}return e.t0=m,e.next=8,w.call(this,c.args[0]);case 8:if(e.t1=e.sent,i=e.t0.cast.call(e.t0,e.t1,"list"),!c.args[1]){e.next=16;break}return e.next=13,w.call(this,c.args[1]);case 13:e.t2=e.sent,e.next=17;break;case 16:e.t2="item";case 17:if(s=e.t2,this.context.forLoop={originalItem:a[s],start:o,items:i,iteration:0,loopVar:s},-1!==(u=t.slice(o+1).findIndex((function(e){return"done"===e.control})))){e.next=22;break}throw Error("Unterminated foreach loop");case 22:if(0!==i.length){e.next=25;break}return o=u,e.abrupt("continue",40);case 25:a[s]=i[0],e.next=40;break;case 28:if("done"!==c.control){e.next=38;break}if(l=this.context,p=l.forLoop,f=l.variables,!p){e.next=35;break}p.iteration++,p.iteration<p.items.length?(o=p.start,f[p.loopVar]=p.items[p.iteration]):("undefined"===typeof p.originalItem?delete f[p.loopVar]:f[p.loopVar]=p.originalItem,this.context.forLoop=null),e.next=36;break;case 35:throw Error("Unexpected control word: ".concat(c.control));case 36:e.next=40;break;case 38:return e.next=40,this.executeStatementOperator(c,n,r);case 40:o++,e.next=2;break;case 43:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeStatementOperator",value:function(){var e=Object(v.a)(d.a.mark((function e(t,n,r){var a,o,c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,c=this.context,i=Object(p.a)(Object(p.a)({},c),{},{variables:Object(p.a)({},c.variables)}),a="&&"===t.operator?this.executeStatementOperator(t.left,n,r).then((function(){return o.context=i,o.executeStatementOperator(t.right,n,r).then((function(){o.context=c}))})):this.executeStatement(t,n,r),!t.background){e.next=8;break}a.catch((function(e){throw e})),e.next=10;break;case 8:return e.next=10,a;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeStatement",value:function(){var e=Object(v.a)(d.a.mark((function e(t,n,r){var a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.context.variables,e.prev=1,e.next=4,w.call(this,t);case 4:o=e.sent,n(k(o)),a[0]=o,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r(e.t0.message);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}();function k(e){return"undefined"===typeof e||null===e?"":e instanceof Date?e.toISOString():Array.isArray(e)?e.map(k).join("\n"):"object"===typeof e?Object.entries(e).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return"".concat(n," = ").concat(k(r))})).join("\n"):String(e)}function w(e){return j.apply(this,arguments)}function j(){return(j=Object(v.a)(d.a.mark((function e(t){var n,r,a,o,c,s,u=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return",t);case 2:if("object"!==typeof t.variable){e.next=9;break}return e.t0=O,e.t1=this,e.next=7,w.call(this,t.variable);case 7:return e.t2=e.sent,e.abrupt("return",e.t0.call.call(e.t0,e.t1,e.t2));case 9:if("string"!==typeof t.variable){e.next=11;break}return e.abrupt("return",O.call(this,t.variable));case 11:if("string"!==typeof t.operator){e.next=36;break}if("="!==t.operator){e.next=20;break}return e.t3=S,e.t4=this,e.t5=t.name,e.next=18,w.call(this,t.value);case 18:return e.t6=e.sent,e.abrupt("return",e.t3.call.call(e.t3,e.t4,e.t5,e.t6));case 20:return e.next=22,w.call(this,t.left);case 22:return n=e.sent,e.next=25,w.call(this,t.right);case 25:if(r=e.sent,!R(n)&&!R(r)){e.next=28;break}return e.abrupt("return",W(t.operator,n,r));case 28:e.t7=t.operator,e.next="+"===e.t7?31:"-"===e.t7?32:"*"===e.t7?33:"/"===e.t7?34:35;break;case 31:return e.abrupt("return",n+r);case 32:return e.abrupt("return",n-r);case 33:return e.abrupt("return",n*r);case 34:return e.abrupt("return",n/r);case 35:throw Error("Unrecognised operator: ".concat(t.operator));case 36:return a=t.command,o=t.args,e.next=39,Promise.all(o.map((function(e){return"object"===typeof e?w.call(u,e):e})));case 39:if(c=e.sent,!(a in m)){e.next=42;break}return e.abrupt("return",(s=m[a]).call.apply(s,[this].concat(Object(i.a)(c))));case 42:return e.abrupt("return",_.call(this,a,c));case 43:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return(E=Object(v.a)(d.a.mark((function e(t){var n,r,a,o,c,s,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.context;case 1:if(!n){e.next=18;break}if(a=(r=n).executables,o=void 0===a?{}:a,c=r.variables,s=void 0===c?{}:c,!("get"in o)){e.next=13;break}return e.prev=4,e.next=7,o.get(t);case 7:return u=e.sent,e.abrupt("return",u);case 11:e.prev=11,e.t0=e.catch(4);case 13:if(!(t in s)){e.next=15;break}return e.abrupt("return",s[t]);case 15:n=n.parent,e.next=1;break;case 18:if("commands"!==t){e.next=20;break}return e.abrupt("return",m.commands.call(this));case 20:if("variables"!==t){e.next=22;break}return e.abrupt("return",[].concat(Object(i.a)(Object.keys(this.context.variables)),["commands","variables"]));case 22:case"end":return e.stop()}}),e,this,[[4,11]])})))).apply(this,arguments)}function S(e,t){return D.apply(this,arguments)}function D(){return(D=Object(v.a)(d.a.mark((function e(t,n){var r,a,o,c,i,s,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.context;case 1:if(!r){e.next=25;break}if(o=(a=r).executables,c=void 0===o?{}:o,i=a.variables,s=void 0===i?{}:i,!("set"in c)){e.next=13;break}return e.prev=4,e.next=7,c.set(t,n);case 7:return u=e.sent,e.abrupt("return",u);case 11:e.prev=11,e.t0=e.catch(4);case 13:if(!(t in s)){e.next=22;break}return e.prev=14,s[t]=n,e.abrupt("return",n);case 19:throw e.prev=19,e.t1=e.catch(14),Error("".concat(t," is readonly"));case 22:r=r.parent,e.next=1;break;case 25:return e.prev=25,this.context.variables[t]=n,e.abrupt("return",n);case 30:throw e.prev=30,e.t2=e.catch(25),Error("".concat(t," is readonly"));case 33:case"end":return e.stop()}}),e,this,[[4,11],[14,19],[25,30]])})))).apply(this,arguments)}function _(e,t){return C.apply(this,arguments)}function C(){return(C=Object(v.a)(d.a.mark((function e(t,n){var r,a,o,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.context;case 1:if(!r){e.next=8;break}if(a=r.executables,!(t in(o=void 0===a?{}:a))){e.next=5;break}return e.abrupt("return",(c=o[t]).call.apply(c,[this].concat(Object(i.a)(n))));case 5:r=r.parent,e.next=1;break;case 8:throw Error("Command '".concat(t,"' not found"));case 9:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function A(e){for(var t=[],n=0,r=[{name:"whitespace",regex:/^\s+/,value:function(){return""}},{name:"string",regex:/^"([^"]*)"/,value:function(e){return e.replace(/\\n/g,"\n").replace(/\\t/g,"\t")}},{name:"string_verbatim",regex:/^'[^']*'/,value:function(e){return e.replace(/\\n/g,"\n").replace(/\\t/g,"\t")}},{name:"num",regex:/^-?\d+(?:\.\d+)?/,value:function(e){return+e}},{name:"variable",regex:/^\$+\w+/},{name:"boolean",regex:/^(true|false)/,value:function(e){return"true"===e}},{name:"punctuation",regex:/^(;|\${|}|&&|[|=+*/&])/},{name:"keyword",regex:/^(foreach|done)/},{name:"name",regex:/^[\w-]+/}];n<e.length;){var a,o=e.substr(n),c=!1,i=Object(u.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value,l=s.regex.exec(o);if(l){var p=l[1]||l[0];s.value instanceof Function?p=s.value(p):"undefined"!==typeof s.value&&(p=s.value),"undefined"!==typeof p&&null!==p&&""!==p&&t.push(p),n+=l[0].length,c=!0;break}}}catch(f){i.e(f)}finally{i.f()}if(!c)throw Error("  ".concat(" ".repeat(n),"^\nUnexpected input at ").concat(n,": ").concat(e.substr(n,10)))}return t}function $(e){return U(e,";").map(I)}function I(e){var t=!1;"&"===e[e.length-1]&&(t=!0,e.length--);var n=function(e){return e.reduce((function(e,t){return null===e?t:{operator:"&&",left:e,right:t}}),null)}(U(e,"&&").map(T));return n.background=t,n}function N(e){if(3===e.length&&"string"===typeof e[0]&&"="===e[1])return{operator:"=",name:e[0],value:e[2]};if(3===e.length&&g.includes(e[1]))return{operator:e[1],left:e[0],right:e[2]};if("undefined"!==typeof e[0].variable){if(e.length>1)throw Error("Variable evaluation must be only node in statement");return e[0]}if("number"===typeof e[0])return e[0];if(x.includes(e[0])){var t=Object(s.a)(e);return{control:t[0],args:t.slice(1)}}var n=Object(s.a)(e);return{command:n[0],args:n.slice(1)}}function T(e){for(var t=[],n=[],r=0;r<e.length;r++){var a=e[r];if("|"===a)t.push(N(n)),n=[];else if("${"===a){var o=e.slice(r+1),c=o.indexOf("}");if(-1===c)throw Error("Unterminated sub-expression");n.push(T(o.slice(0,c))),r+=c+1}else if("number"===typeof a)n.push(a);else if("string"===typeof a&&"$"===a[0]){var i=a.substr(1),s={variable:i};"$"===i[0]&&(s={variable:{variable:i.substr(1)}}),n.push(s)}else if("string"===typeof a&&"'"===a[0]){var u=a.substr(1,a.length-2);n.push(u)}else n.push(a)}if(0===n.length)throw Error("Empty pipe segment");return t.push(N(n)),function(e){return e.reduce((function(e,t){if(null===e)return t;if("undefined"!==typeof t.variable)return{operator:"=",name:t.variable,value:e};if(!t.args)throw Error("Unable to pipe to ".concat(typeof t));return t.args.unshift(e),t}),null)}(t)}function U(e,t){for(var n=[],r=[],a=0;a<e.length;a++)e[a]===t&&r.length?(n.push(r),r=[]):r.push(e[a]);return r.length&&n.push(r),n}function M(e){return!function(e){return"undefined"===typeof e||null===e||""===e}(e)}function R(e){return e instanceof Date}function W(e,t,n){if(t instanceof Date&&n instanceof Date){if("-"===e)return+t-+n;throw Error("Invalid date calc")}if("+"!==e)throw Error("Invalid date calc");return new Date(+t+ +n)}var P={ConsoleDisplay:"_console__ConsoleDisplay__2okS3","ConsoleDisplay-hist-input":"_console__ConsoleDisplay-hist-input__2k9nO","ConsoleDisplay-hist-error":"_console__ConsoleDisplay-hist-error__23Wsh"};function J(e){var t=e.shell,n=void 0===t?null:t,r=e.context,o=void 0===r?{}:r,c=e.style,s=void 0===c?{}:c,u=e.onClose,f=void 0===u?null:u,h=a.a.useState([]),b=Object(l.a)(h,2),m=b[0],x=b[1],g=a.a.useState(""),k=Object(l.a)(g,2),w=k[0],j=k[1],O=a.a.useState(0),E=Object(l.a)(O,2),S=E[0],D=E[1],_=a.a.useState(!1),C=Object(l.a)(_,2),A=C[0],$=C[1],I=a.a.useRef(),N=a.a.useRef(n||new y(o)),T=a.a.useRef(),U=a.a.useState(s.color),M=Object(l.a)(U,2),R=M[0],W=M[1],J=a.a.useState(s.backgroundColor),V=Object(l.a)(J,2),H=V[0],K=V[1];a.a.useEffect((function(){o.parent={variables:{textColor:R,backgroundColor:H},executables:{set(e,t){if("textColor"===e)return W(t);if("backgroundColor"===e)return K(t);throw Error("Unhandled")},exit:f||function(){},clear:function(){return x([])}}}}),[o,R,W,H,K,f,x]),a.a.useEffect((function(){I.current&&I.current.focus(),T.current&&(T.current.scrollTop=T.current.scrollHeight)}),[m,A]);var L=a.a.useCallback((function(e){function t(e){x((function(t){return[].concat(Object(i.a)(t),[e])}))}function n(){return(n=Object(v.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),j(""),D(0),t({value:w,type:"input"}),!N.current){e.next=11;break}return $(!0),e.next=8,N.current.execute(w,(function(e){t({value:e,type:"output"})}),(function(e){t({value:e,type:"error"})}));case 8:$(!1),e.next=12;break;case 11:t({value:"No interpreter specified",type:"error"});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){n.apply(this,arguments)}(e)}),[w,j,D,x,$]);var B=Object(p.a)(Object(p.a)({},s),{},{color:R,background:H});return a.a.createElement("div",{className:P.ConsoleDisplay,ref:T,onClick:function(){return"Range"!==getSelection().type&&I.current.focus()},style:B},a.a.createElement("ul",null,m.map((function(e,t){return a.a.createElement("li",{key:t,className:P["ConsoleDisplay-hist-".concat(e.type)]},e.value)}))),a.a.createElement("form",{onSubmit:L},!A&&"> ",a.a.createElement("input",{value:w,ref:I,disabled:A,onChange:function(e){return j(e.target.value)},onKeyUp:function(e){var t=m.filter((function(e){return"input"===e.type&&e.value})),n=NaN;"ArrowUp"===e.key?n=Math.min(S+1,t.length):"ArrowDown"===e.key&&(n=Math.max(S-1,0)),isNaN(n)||(D(n),0===n&&0!==S?j(""):0!==n&&j(t[t.length-n].value))},onKeyDown:function(e){return"ArrowUp"===e.key&&e.preventDefault()},autoFocus:!0})))}n(26);var V={demo(){return this.execute('\necho Welcome to the demo "script.";\nsleep 1;\necho Sit back and watch some sample commands;\nsleep 1;\necho executed before your "eyes!";\nsleep 1;\necho ">" date;\ndate;\nsleep 1;\necho ">" sleep 3;\nsleep 3;\necho ">" date;\ntee ${date} d;\nsleep 1;\necho ">" echo \'$0\';\necho $d;\nsleep 1;\necho ">" 5 + 2;\n5 + 2;\nsleep 1;\necho ">" a = \'${6 * 2}\';\na = ${6 * 2};\nsleep 1;\necho ">" echo Answer is \'$a\';\necho Answer is $a;\nsleep 1;\necho ">" range 3;\nrange 3;\nsleep 1;\necho ">" \'$0 | json\';\nrange 3 | json;\nsleep 1;\necho \'> range 50 | grep 7\' ;\nrange 50 | grep 7;\nsleep 1;\necho \'> foreach ${range 10}; sleep 1; $item; done;\';\nforeach ${range 10}; sleep 1; $item; done;\necho \' \';\necho \'Thanks!\';\n')}};var H=function(){return a.a.createElement("div",{className:"App"},a.a.createElement("p",null,"Type demo or help to get started."),a.a.createElement(J,{context:{executables:V}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.dcb5462d.chunk.js.map